{"ast":null,"code":"export class Connection {\n  constructor(validatedOrigin, targetWindow) {\n    this.validatedOrigin = validatedOrigin;\n    this.targetWindow = targetWindow;\n    this.handlers = new Map();\n  }\n  off(event, callback) {\n    const eventCallbacks = this.handlers.get(event);\n    eventCallbacks === null || eventCallbacks === void 0 ? void 0 : eventCallbacks.delete(callback);\n  }\n  on(event, callback) {\n    var _a;\n    const eventCallbacks = (_a = this.handlers.get(event)) !== null && _a !== void 0 ? _a : new Set();\n    eventCallbacks.add(callback);\n    this.handlers.set(event, eventCallbacks);\n  }\n  send(_ref) {\n    let {\n      event,\n      payload\n    } = _ref;\n    this.targetWindow.postMessage({\n      event,\n      payload\n    }, this.validatedOrigin);\n  }\n  runHandlersForEvent(event, payload) {\n    const eventCallbacks = this.handlers.get(event);\n    if (!eventCallbacks) {\n      return;\n    }\n    for (const callback of eventCallbacks) {\n      callback(payload);\n    }\n  }\n  resetHandlers() {\n    this.handlers.clear();\n  }\n  export() {\n    return {\n      off: this.off.bind(this),\n      on: this.on.bind(this),\n      send: this.send.bind(this),\n      validatedOrigin: this.validatedOrigin\n    };\n  }\n}","map":{"version":3,"names":["Connection","constructor","validatedOrigin","targetWindow","handlers","Map","off","event","callback","eventCallbacks","get","delete","on","_a","Set","add","set","send","_ref","payload","postMessage","runHandlersForEvent","resetHandlers","clear","export","bind"],"sources":["../../../src/core/connection.ts"],"sourcesContent":[null],"mappings":"AASA,OAAM,MAAOA,UAAU;EAGrBC,YACWC,eAAuB,EACvBC,YAAoB;IADpB,KAAAD,eAAe,GAAfA,eAAe;IACf,KAAAC,YAAY,GAAZA,YAAY;IAJN,KAAAC,QAAQ,GAAG,IAAIC,GAAG,EAAkC;EAKlE;EAEHC,GAAGA,CAACC,KAAiB,EAAEC,QAAuB;IAC5C,MAAMC,cAAc,GAAG,IAAI,CAACL,QAAQ,CAACM,GAAG,CAACH,KAAK,CAAC;IAC/CE,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEE,MAAM,CAACH,QAAQ,CAAC;EAClC;EAEAI,EAAEA,CAACL,KAAiB,EAAEC,QAAuB;;IAC3C,MAAMC,cAAc,GAAG,CAAAI,EAAA,OAAI,CAACT,QAAQ,CAACM,GAAG,CAACH,KAAK,CAAC,cAAAM,EAAA,cAAAA,EAAA,GAAI,IAAIC,GAAG,EAAiB;IAC3EL,cAAc,CAACM,GAAG,CAACP,QAAQ,CAAC;IAC5B,IAAI,CAACJ,QAAQ,CAACY,GAAG,CAACT,KAAK,EAAEE,cAAc,CAAC;EAC1C;EAEAQ,IAAIA,CAAAC,IAAA,EAA2D;IAAA,IAA1D;MAAEX,KAAK;MAAEY;IAAO,CAA0C,GAAAD,IAAA;IAC7D,IAAI,CAACf,YAAY,CAACiB,WAAW,CAC3B;MACEb,KAAK;MACLY;KACD,EACD,IAAI,CAACjB,eAAe,CACrB;EACH;EAEAmB,mBAAmBA,CAACd,KAAiB,EAAEY,OAAgB;IACrD,MAAMV,cAAc,GAAG,IAAI,CAACL,QAAQ,CAACM,GAAG,CAACH,KAAK,CAAC;IAC/C,IAAI,CAACE,cAAc,EAAE;MACnB;;IAEF,KAAK,MAAMD,QAAQ,IAAIC,cAAc,EAAE;MACrCD,QAAQ,CAACW,OAAO,CAAC;;EAErB;EAEAG,aAAaA,CAAA;IACX,IAAI,CAAClB,QAAQ,CAACmB,KAAK,EAAE;EACvB;EAEAC,MAAMA,CAAA;IACJ,OAAO;MACLlB,GAAG,EAAE,IAAI,CAACA,GAAG,CAACmB,IAAI,CAAC,IAAI,CAAC;MACxBb,EAAE,EAAE,IAAI,CAACA,EAAE,CAACa,IAAI,CAAC,IAAI,CAAC;MACtBR,IAAI,EAAE,IAAI,CAACA,IAAI,CAACQ,IAAI,CAAC,IAAI,CAAC;MAC1BvB,eAAe,EAAE,IAAI,CAACA;KACvB;EACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}